DISABLE=-z norelro

all: server_0 server_0b server_1 server_2

server_0: server.c malloc-2.7.2.c
	gcc -g $(DISABLE) -no-pie -z execstack -DSERVER_0 -DPORT=7000 -o server_0 server.c

server_0b: server.c
	gcc -g $(DISABLE) -no-pie -z execstack -DSERVER_0b -DPORT=7000 -o server_0b server.c

server_1: server.c malloc-2.7.2.c
	gcc -g $(DISABLE) -no-pie -z noexecstack -DSERVER_1 -DPORT=7001 -o server_1 server.c

server_2: server.c malloc-2.7.2.c
	gcc -g $(DISABLE) -no-pie -z relro -z now -z noexecstack -DSERVER_2 -DPORT=7002 -o server_2 server.c libc.so.6

.PHONY: clean
clean:
	rm -f server_?
